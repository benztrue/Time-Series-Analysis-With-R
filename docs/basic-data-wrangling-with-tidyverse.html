<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Basic Data Wrangling with Tidyverse | Time Series Analysis With R</title>
  <meta name="description" content="Chapter 3 Basic Data Wrangling with Tidyverse | Time Series Analysis With R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Basic Data Wrangling with Tidyverse | Time Series Analysis With R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Basic Data Wrangling with Tidyverse | Time Series Analysis With R" />
  
  
  

<meta name="author" content="Nicola Righetti" />


<meta name="date" content="2021-06-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="getting-started-with-r.html"/>
<link rel="next" href="basic-concepts.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Time Series Analysis With R</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i><b>1.1</b> Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#lectures"><i class="fa fa-check"></i><b>1.2</b> Lectures</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#home-work"><i class="fa fa-check"></i><b>1.3</b> Home Work</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i><b>1.4</b> Assessment</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#syllabus-and-readings"><i class="fa fa-check"></i><b>1.5</b> Syllabus and readings</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#further-information-and-support"><i class="fa fa-check"></i><b>1.6</b> Further information and support</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting started with R</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#rstudio-interface-and-data"><i class="fa fa-check"></i><b>2.1</b> RStudio Interface and Data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#download-and-install-rstudio"><i class="fa fa-check"></i><b>2.1.1</b> Download and Install RStudio</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#create-a-rstudio-project-and-import-data"><i class="fa fa-check"></i><b>2.1.2</b> Create a RStudio Project and Import data</a></li>
<li class="chapter" data-level="2.1.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#create-a-script"><i class="fa fa-check"></i><b>2.1.3</b> Create a Script</a></li>
<li class="chapter" data-level="2.1.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#the-rstudio-user-interface"><i class="fa fa-check"></i><b>2.1.4</b> The RStudio User Interface</a></li>
<li class="chapter" data-level="2.1.5" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#load-and-save-data"><i class="fa fa-check"></i><b>2.1.5</b> Load and Save Data</a></li>
<li class="chapter" data-level="2.1.6" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#create-new-folders"><i class="fa fa-check"></i><b>2.1.6</b> Create new Folders</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#basic-r"><i class="fa fa-check"></i><b>2.2</b> Basic R</a><ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#objects"><i class="fa fa-check"></i><b>2.2.1</b> Objects</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#functions"><i class="fa fa-check"></i><b>2.2.2</b> Functions</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#data-types"><i class="fa fa-check"></i><b>2.2.3</b> Data Types</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#excercise"><i class="fa fa-check"></i><b>2.2.4</b> Excercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-data-wrangling-with-tidyverse.html"><a href="basic-data-wrangling-with-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Basic Data Wrangling with Tidyverse</a><ul>
<li class="chapter" data-level="3.1" data-path="basic-data-wrangling-with-tidyverse.html"><a href="basic-data-wrangling-with-tidyverse.html#the-pipe-operator"><i class="fa fa-check"></i><b>3.1</b> The Pipe Operator %&gt;%</a></li>
<li class="chapter" data-level="3.2" data-path="basic-data-wrangling-with-tidyverse.html"><a href="basic-data-wrangling-with-tidyverse.html#mutate"><i class="fa fa-check"></i><b>3.2</b> Mutate</a></li>
<li class="chapter" data-level="3.3" data-path="basic-data-wrangling-with-tidyverse.html"><a href="basic-data-wrangling-with-tidyverse.html#rename"><i class="fa fa-check"></i><b>3.3</b> Rename</a></li>
<li class="chapter" data-level="3.4" data-path="basic-data-wrangling-with-tidyverse.html"><a href="basic-data-wrangling-with-tidyverse.html#summarize-and-group_by"><i class="fa fa-check"></i><b>3.4</b> Summarize and group_by</a><ul>
<li class="chapter" data-level="3.4.1" data-path="basic-data-wrangling-with-tidyverse.html"><a href="basic-data-wrangling-with-tidyverse.html#count-occurrences"><i class="fa fa-check"></i><b>3.4.1</b> Count occurrences</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="basic-data-wrangling-with-tidyverse.html"><a href="basic-data-wrangling-with-tidyverse.html#arrange"><i class="fa fa-check"></i><b>3.5</b> Arrange</a></li>
<li class="chapter" data-level="3.6" data-path="basic-data-wrangling-with-tidyverse.html"><a href="basic-data-wrangling-with-tidyverse.html#filter"><i class="fa fa-check"></i><b>3.6</b> Filter</a></li>
<li class="chapter" data-level="3.7" data-path="basic-data-wrangling-with-tidyverse.html"><a href="basic-data-wrangling-with-tidyverse.html#select"><i class="fa fa-check"></i><b>3.7</b> Select</a></li>
<li class="chapter" data-level="3.8" data-path="basic-data-wrangling-with-tidyverse.html"><a href="basic-data-wrangling-with-tidyverse.html#exercise"><i class="fa fa-check"></i><b>3.8</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-concepts.html"><a href="basic-concepts.html"><i class="fa fa-check"></i><b>4</b> Basic Concepts</a><ul>
<li class="chapter" data-level="4.1" data-path="basic-concepts.html"><a href="basic-concepts.html#time-series"><i class="fa fa-check"></i><b>4.1</b> Time Series</a></li>
<li class="chapter" data-level="4.2" data-path="basic-concepts.html"><a href="basic-concepts.html#time-series-analysis"><i class="fa fa-check"></i><b>4.2</b> Time Series Analysis</a></li>
<li class="chapter" data-level="4.3" data-path="basic-concepts.html"><a href="basic-concepts.html#stochastic-and-deterministic-processes"><i class="fa fa-check"></i><b>4.3</b> Stochastic and Deterministic Processes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="time-series-objects.html"><a href="time-series-objects.html"><i class="fa fa-check"></i><b>5</b> Time Series Objects</a><ul>
<li class="chapter" data-level="5.1" data-path="time-series-objects.html"><a href="time-series-objects.html#time-series-objects-1"><i class="fa fa-check"></i><b>5.1</b> Time Series Objects</a><ul>
<li class="chapter" data-level="5.1.1" data-path="time-series-objects.html"><a href="time-series-objects.html#time-series-as-data-frames"><i class="fa fa-check"></i><b>5.1.1</b> Time Series as Data Frames</a></li>
<li class="chapter" data-level="5.1.2" data-path="time-series-objects.html"><a href="time-series-objects.html#time-series-as-ts-objects"><i class="fa fa-check"></i><b>5.1.2</b> Time Series as TS objects</a></li>
<li class="chapter" data-level="5.1.3" data-path="time-series-objects.html"><a href="time-series-objects.html#time-series-as-xtszoo-objects"><i class="fa fa-check"></i><b>5.1.3</b> Time Series as XTS/ZOO objects</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="time-series-objects.html"><a href="time-series-objects.html#exercise-1"><i class="fa fa-check"></i><b>5.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="plot-time-series.html"><a href="plot-time-series.html"><i class="fa fa-check"></i><b>6</b> Plot Time Series</a><ul>
<li class="chapter" data-level="6.1" data-path="plot-time-series.html"><a href="plot-time-series.html#plot-time-series-objects"><i class="fa fa-check"></i><b>6.1</b> Plot Time Series Objects</a></li>
<li class="chapter" data-level="6.2" data-path="plot-time-series.html"><a href="plot-time-series.html#plot.ts"><i class="fa fa-check"></i><b>6.2</b> plot.ts</a></li>
<li class="chapter" data-level="6.3" data-path="plot-time-series.html"><a href="plot-time-series.html#plot.xts"><i class="fa fa-check"></i><b>6.3</b> plot.xts</a></li>
<li class="chapter" data-level="6.4" data-path="plot-time-series.html"><a href="plot-time-series.html#ggplot"><i class="fa fa-check"></i><b>6.4</b> ggplot</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="structural-decomposition.html"><a href="structural-decomposition.html"><i class="fa fa-check"></i><b>7</b> Structural Decomposition</a><ul>
<li class="chapter" data-level="7.1" data-path="structural-decomposition.html"><a href="structural-decomposition.html#components-of-a-time-series"><i class="fa fa-check"></i><b>7.1</b> Components of a time series</a><ul>
<li class="chapter" data-level="7.1.1" data-path="structural-decomposition.html"><a href="structural-decomposition.html#trend-and-cycle"><i class="fa fa-check"></i><b>7.1.1</b> Trend and Cycle</a></li>
<li class="chapter" data-level="7.1.2" data-path="structural-decomposition.html"><a href="structural-decomposition.html#stochastic-and-deterministic-trend"><i class="fa fa-check"></i><b>7.1.2</b> Stochastic and Deterministic Trend</a></li>
<li class="chapter" data-level="7.1.3" data-path="structural-decomposition.html"><a href="structural-decomposition.html#seasonality"><i class="fa fa-check"></i><b>7.1.3</b> Seasonality</a></li>
<li class="chapter" data-level="7.1.4" data-path="structural-decomposition.html"><a href="structural-decomposition.html#residuals"><i class="fa fa-check"></i><b>7.1.4</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="structural-decomposition.html"><a href="structural-decomposition.html#structural-decomposition-1"><i class="fa fa-check"></i><b>7.2</b> Structural decomposition</a><ul>
<li class="chapter" data-level="7.2.1" data-path="structural-decomposition.html"><a href="structural-decomposition.html#moving-average"><i class="fa fa-check"></i><b>7.2.1</b> Moving Average</a></li>
<li class="chapter" data-level="7.2.2" data-path="structural-decomposition.html"><a href="structural-decomposition.html#decompose"><i class="fa fa-check"></i><b>7.2.2</b> Decompose</a></li>
<li class="chapter" data-level="7.2.3" data-path="structural-decomposition.html"><a href="structural-decomposition.html#compare-additive-and-multiplicative-models"><i class="fa fa-check"></i><b>7.2.3</b> Compare Additive and Multiplicative Models</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="structural-decomposition.html"><a href="structural-decomposition.html#adjust-time-series"><i class="fa fa-check"></i><b>7.3</b> Adjust time series</a><ul>
<li class="chapter" data-level="7.3.1" data-path="structural-decomposition.html"><a href="structural-decomposition.html#seasonal-adjusted-data"><i class="fa fa-check"></i><b>7.3.1</b> Seasonal adjusted data</a></li>
<li class="chapter" data-level="7.3.2" data-path="structural-decomposition.html"><a href="structural-decomposition.html#detrended-series"><i class="fa fa-check"></i><b>7.3.2</b> Detrended series</a></li>
<li class="chapter" data-level="7.3.3" data-path="structural-decomposition.html"><a href="structural-decomposition.html#other-decomposition-methods-in-r"><i class="fa fa-check"></i><b>7.3.3</b> Other Decomposition Methods in R</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="structural-decomposition.html"><a href="structural-decomposition.html#white-noise-and-stationarity"><i class="fa fa-check"></i><b>7.4</b> White Noise and Stationarity</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html"><i class="fa fa-check"></i><b>8</b> Correlations and ARIMA</a><ul>
<li class="chapter" data-level="8.1" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html#auto-correlation-acf-and-pacf"><i class="fa fa-check"></i><b>8.1</b> Auto-Correlation (ACF and PACF)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html#correlogram-acf-and-pacf"><i class="fa fa-check"></i><b>8.1.1</b> Correlogram: ACF and PACF</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html#arima-models"><i class="fa fa-check"></i><b>8.2</b> ARIMA models</a><ul>
<li class="chapter" data-level="8.2.1" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html#auto-regressive-ar-models"><i class="fa fa-check"></i><b>8.2.1</b> Auto Regressive (AR) models</a></li>
<li class="chapter" data-level="8.2.2" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html#moving-average-ma-models"><i class="fa fa-check"></i><b>8.2.2</b> Moving Average (MA) models</a></li>
<li class="chapter" data-level="8.2.3" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html#integrated-i-process"><i class="fa fa-check"></i><b>8.2.3</b> Integrated (I) process</a></li>
<li class="chapter" data-level="8.2.4" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html#seasonal-s-models"><i class="fa fa-check"></i><b>8.2.4</b> Seasonal (S) models</a></li>
<li class="chapter" data-level="8.2.5" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html#fit-sarima-models"><i class="fa fa-check"></i><b>8.2.5</b> Fit (S)ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html#cross-correlation"><i class="fa fa-check"></i><b>8.3</b> Cross-correlation</a></li>
<li class="chapter" data-level="8.4" data-path="correlations-and-arima.html"><a href="correlations-and-arima.html#examples-in-literature"><i class="fa fa-check"></i><b>8.4</b> Examples in literature</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#static-and-dynamic-models"><i class="fa fa-check"></i><b>9.1</b> Static and Dynamic Models</a></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#regression-models"><i class="fa fa-check"></i><b>9.2</b> Regression models</a><ul>
<li class="chapter" data-level="9.2.1" data-path="regression.html"><a href="regression.html#stationarity"><i class="fa fa-check"></i><b>9.2.1</b> Stationarity</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#non-autocorrelated-residuals"><i class="fa fa-check"></i><b>9.2.2</b> Non-autocorrelated residuals</a></li>
<li class="chapter" data-level="9.2.3" data-path="regression.html"><a href="regression.html#regression-with-arma-errors"><i class="fa fa-check"></i><b>9.2.3</b> Regression with ARMA errors</a></li>
<li class="chapter" data-level="9.2.4" data-path="regression.html"><a href="regression.html#count-regression-models"><i class="fa fa-check"></i><b>9.2.4</b> Count regression models</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#model-selection-aic-aicc-bic"><i class="fa fa-check"></i><b>9.3</b> Model Selection (AIC, AICc, BIC)</a></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#some-examples-in-the-literature"><i class="fa fa-check"></i><b>9.4</b> Some examples in the literature</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="intervention-analysis.html"><a href="intervention-analysis.html"><i class="fa fa-check"></i><b>10</b> Intervention Analysis</a><ul>
<li class="chapter" data-level="10.1" data-path="intervention-analysis.html"><a href="intervention-analysis.html#types-of-intervention"><i class="fa fa-check"></i><b>10.1</b> Types of intervention</a></li>
<li class="chapter" data-level="10.2" data-path="intervention-analysis.html"><a href="intervention-analysis.html#intervention-analysis-with-arima"><i class="fa fa-check"></i><b>10.2</b> Intervention analysis with ARIMA</a></li>
<li class="chapter" data-level="10.3" data-path="intervention-analysis.html"><a href="intervention-analysis.html#causalimpact"><i class="fa fa-check"></i><b>10.3</b> CausalImpact</a><ul>
<li class="chapter" data-level="10.3.1" data-path="intervention-analysis.html"><a href="intervention-analysis.html#exercise-2"><i class="fa fa-check"></i><b>10.3.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="var-introduction.html"><a href="var-introduction.html"><i class="fa fa-check"></i><b>11</b> VAR (Introduction)</a></li>
<li class="chapter" data-level="12" data-path="readings-and-bibliographical-references.html"><a href="readings-and-bibliographical-references.html"><i class="fa fa-check"></i><b>12</b> Readings and Bibliographical References</a><ul>
<li class="chapter" data-level="12.1" data-path="readings-and-bibliographical-references.html"><a href="readings-and-bibliographical-references.html#useful-resources"><i class="fa fa-check"></i><b>12.1</b> Useful resources</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series Analysis With R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-data-wrangling-with-tidyverse" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Basic Data Wrangling with Tidyverse</h1>
<p><a href="https://en.wikipedia.org/wiki/Data_wrangling">Data wrangling</a> <em>is the process of transforming and mapping data from one “raw” data form into another format with the intent of making it more appropriate and valuable for a variety of downstream purposes such as analytics. The goal of data wrangling is to assure quality and useful data. Data analysts typically spend the majority of their time in the process of data wrangling compared to the actual analysis of the data.</em></p>
<p><a href="https://link.springer.com/referenceworkentry/10.1007%2F978-3-319-63962-8_9-1">Another definition</a> is as follows: <em>Data wrangling is the process of profiling and transforming datasets to ensure they are actionable for a set of analysis tasks. One central goal is to make data usable: to put data in a form that can be parsed and manipulated by analysis tools. Another goal is to ensure that data is responsive to the intended analyses: that the data contain the necessary information, at an acceptable level of description and correctness, to support successful modeling and decision-making.</em></p>
<p>How to “manipulate” data sets in R:</p>
<ul>
<li>use basic R functions;</li>
<li>employ specific libraries such as <strong>tidyverse</strong>. Tidyverse is an R library composed of functions that allow users to perform basic and advanced data science operations. <a href="https://www.tidyverse.org">https://www.tidyverse.org</a>.</li>
</ul>
<p>In R, a <strong>library (or “package”)</strong> is a coherent collection of functions, usually created for specific purposes.</p>
<p>To work with the <em>tidyverse</em> library, it is necessary to install it first, by using the following command: <em>install.packages(“tidyverse”)</em>.</p>
<p>After having installed tidyverse (or any other library), it is necessary to load it, so as we can work with its functions in the current R session:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="basic-data-wrangling-with-tidyverse.html#cb56-1"></a><span class="co"># to load a library used the command library(NAME-OF-THE-LIBRARY)</span></span>
<span id="cb56-2"><a href="basic-data-wrangling-with-tidyverse.html#cb56-2"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
## ✓ tibble  3.0.4     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<p>Besides using the function <em>install.packages(NAME-OF-THE-LIBRARY)</em> by using a line of code, it is also possible to use the RStudio interface.</p>
<div class="figure">
<video src="videos/install-load-library.mov" style="width:80.0%" controls=""><a href="videos/install-load-library.mov"></a></video>
<p class="caption">Install and Load a Library</p>
</div>
<div id="the-pipe-operator" class="section level2">
<h2><span class="header-section-number">3.1</span> The Pipe Operator %&gt;%</h2>
<p>Tidyverse has a peculiar syntax that makes use of the so-called <a href="https://style.tidyverse.org/pipes.html"><strong>pipe</strong></a> operator <strong>%&gt;%</strong>, like in the following example:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="basic-data-wrangling-with-tidyverse.html#cb60-1"></a>a_dataframe <span class="op">%&gt;%</span></span>
<span id="cb60-2"><a href="basic-data-wrangling-with-tidyverse.html#cb60-2"></a><span class="st">  </span><span class="kw">group_by</span>(second_variable) <span class="op">%&gt;%</span></span>
<span id="cb60-3"><a href="basic-data-wrangling-with-tidyverse.html#cb60-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(a_new_variable))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 7 x 2
##   second_variable  mean
##   &lt;fct&gt;           &lt;dbl&gt;
## 1 Friday            3  
## 2 Monday           37  
## 3 Saturday        140. 
## 4 Sunday           48  
## 5 Thursday         25.5
## 6 Tuesday         145  
## 7 Wednesday       138</code></pre>
<p>To manipulate data sets we can rely on the functions included in <a href="https://dplyr.tidyverse.org"><strong>dplyr</strong></a>: <em>a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges</em>, such as <em>mutate</em>, <em>rename</em>, <em>summarize</em>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="basic-data-wrangling-with-tidyverse.html#cb63-1"></a><span class="kw">library</span>(readr)</span>
<span id="cb63-2"><a href="basic-data-wrangling-with-tidyverse.html#cb63-2"></a>tweets &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/tweets_covid_small.csv&quot;</span>, </span>
<span id="cb63-3"><a href="basic-data-wrangling-with-tidyverse.html#cb63-3"></a>    <span class="dt">col_types =</span> <span class="kw">cols</span>(<span class="dt">created_at =</span> <span class="kw">col_datetime</span>(<span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d %H:%M:%S&quot;</span>), </span>
<span id="cb63-4"><a href="basic-data-wrangling-with-tidyverse.html#cb63-4"></a>        <span class="dt">retweet_count =</span> <span class="kw">col_integer</span>()))</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="basic-data-wrangling-with-tidyverse.html#cb64-1"></a><span class="kw">head</span>(tweets)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   created_at          screen_name   source             retweet_count
##   &lt;dttm&gt;              &lt;chr&gt;         &lt;chr&gt;                      &lt;int&gt;
## 1 2021-03-24 08:53:52 DoYourThingUK Twitter for iPhone             0
## 2 2021-03-24 08:53:25 DoYourThingUK Twitter for iPhone             0
## 3 2021-03-24 08:53:52 AlexS1595     Twitter for iPhone             3
## 4 2021-03-24 08:53:51 MakesworthAcc Twitter Web App                0
## 5 2021-03-24 08:53:39 MakesworthAcc Twitter Web App                4
## 6 2021-03-24 08:53:51 GGrahambute   Twitter for iPad              96</code></pre>
<div class="figure">
<video src="videos/upload-covid-tweets-small.mov" style="width:80.0%" controls=""><a href="videos/upload-covid-tweets-small.mov"></a></video>
<p class="caption">Import data and specify data types (dates and times)</p>
</div>
</div>
<div id="mutate" class="section level2">
<h2><span class="header-section-number">3.2</span> Mutate</h2>
<p>The function <strong>mutate</strong> adds new variables to a data.frame or overwrites existing variables.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="basic-data-wrangling-with-tidyverse.html#cb66-1"></a>tweets &lt;-<span class="st"> </span>tweets <span class="op">%&gt;%</span></span>
<span id="cb66-2"><a href="basic-data-wrangling-with-tidyverse.html#cb66-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_retweet_count =</span> <span class="kw">log</span>(retweet_count))</span>
<span id="cb66-3"><a href="basic-data-wrangling-with-tidyverse.html#cb66-3"></a>  </span>
<span id="cb66-4"><a href="basic-data-wrangling-with-tidyverse.html#cb66-4"></a><span class="kw">head</span>(tweets)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   created_at          screen_name   source             retweet_count log_retweet_count
##   &lt;dttm&gt;              &lt;chr&gt;         &lt;chr&gt;                      &lt;int&gt;             &lt;dbl&gt;
## 1 2021-03-24 08:53:52 DoYourThingUK Twitter for iPhone             0           -Inf   
## 2 2021-03-24 08:53:25 DoYourThingUK Twitter for iPhone             0           -Inf   
## 3 2021-03-24 08:53:52 AlexS1595     Twitter for iPhone             3              1.10
## 4 2021-03-24 08:53:51 MakesworthAcc Twitter Web App                0           -Inf   
## 5 2021-03-24 08:53:39 MakesworthAcc Twitter Web App                4              1.39
## 6 2021-03-24 08:53:51 GGrahambute   Twitter for iPad              96              4.56</code></pre>
</div>
<div id="rename" class="section level2">
<h2><span class="header-section-number">3.3</span> Rename</h2>
<p>Rename is a function to change the name of columns (sometimes it could be useful).</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="basic-data-wrangling-with-tidyverse.html#cb68-1"></a>tweets &lt;-<span class="st"> </span>tweets <span class="op">%&gt;%</span></span>
<span id="cb68-2"><a href="basic-data-wrangling-with-tidyverse.html#cb68-2"></a><span class="st">  </span><span class="co"># rename (new_name = old_name)</span></span>
<span id="cb68-3"><a href="basic-data-wrangling-with-tidyverse.html#cb68-3"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">device =</span> source)</span>
<span id="cb68-4"><a href="basic-data-wrangling-with-tidyverse.html#cb68-4"></a></span>
<span id="cb68-5"><a href="basic-data-wrangling-with-tidyverse.html#cb68-5"></a><span class="kw">head</span>(tweets)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   created_at          screen_name   device             retweet_count log_retweet_count
##   &lt;dttm&gt;              &lt;chr&gt;         &lt;chr&gt;                      &lt;int&gt;             &lt;dbl&gt;
## 1 2021-03-24 08:53:52 DoYourThingUK Twitter for iPhone             0           -Inf   
## 2 2021-03-24 08:53:25 DoYourThingUK Twitter for iPhone             0           -Inf   
## 3 2021-03-24 08:53:52 AlexS1595     Twitter for iPhone             3              1.10
## 4 2021-03-24 08:53:51 MakesworthAcc Twitter Web App                0           -Inf   
## 5 2021-03-24 08:53:39 MakesworthAcc Twitter Web App                4              1.39
## 6 2021-03-24 08:53:51 GGrahambute   Twitter for iPad              96              4.56</code></pre>
<p>The previous two steps can be performed at the same time, by concatenating the operations through the <em>pipe %&gt;%</em> operator.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="basic-data-wrangling-with-tidyverse.html#cb70-1"></a><span class="co"># load again the data set</span></span>
<span id="cb70-2"><a href="basic-data-wrangling-with-tidyverse.html#cb70-2"></a><span class="kw">library</span>(readr)</span>
<span id="cb70-3"><a href="basic-data-wrangling-with-tidyverse.html#cb70-3"></a>tweets &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/tweets_covid_small.csv&quot;</span>, </span>
<span id="cb70-4"><a href="basic-data-wrangling-with-tidyverse.html#cb70-4"></a>    <span class="dt">col_types =</span> <span class="kw">cols</span>(<span class="dt">created_at =</span> <span class="kw">col_datetime</span>(<span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d %H:%M:%S&quot;</span>), </span>
<span id="cb70-5"><a href="basic-data-wrangling-with-tidyverse.html#cb70-5"></a>        <span class="dt">retweet_count =</span> <span class="kw">col_integer</span>()))</span>
<span id="cb70-6"><a href="basic-data-wrangling-with-tidyverse.html#cb70-6"></a></span>
<span id="cb70-7"><a href="basic-data-wrangling-with-tidyverse.html#cb70-7"></a>tweets &lt;-<span class="st"> </span>tweets <span class="op">%&gt;%</span></span>
<span id="cb70-8"><a href="basic-data-wrangling-with-tidyverse.html#cb70-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_retweet_count =</span> <span class="kw">log</span>(retweet_count<span class="op">+</span><span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb70-9"><a href="basic-data-wrangling-with-tidyverse.html#cb70-9"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">device =</span> source)</span>
<span id="cb70-10"><a href="basic-data-wrangling-with-tidyverse.html#cb70-10"></a></span>
<span id="cb70-11"><a href="basic-data-wrangling-with-tidyverse.html#cb70-11"></a><span class="kw">head</span>(tweets)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   created_at          screen_name   device             retweet_count log_retweet_count
##   &lt;dttm&gt;              &lt;chr&gt;         &lt;chr&gt;                      &lt;int&gt;             &lt;dbl&gt;
## 1 2021-03-24 08:53:52 DoYourThingUK Twitter for iPhone             0              0   
## 2 2021-03-24 08:53:25 DoYourThingUK Twitter for iPhone             0              0   
## 3 2021-03-24 08:53:52 AlexS1595     Twitter for iPhone             3              1.39
## 4 2021-03-24 08:53:51 MakesworthAcc Twitter Web App                0              0   
## 5 2021-03-24 08:53:39 MakesworthAcc Twitter Web App                4              1.61
## 6 2021-03-24 08:53:51 GGrahambute   Twitter for iPad              96              4.57</code></pre>
<p>To check the data format of the variables stored in the data.frame, it can be used the command <em>str()</em>:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="basic-data-wrangling-with-tidyverse.html#cb72-1"></a><span class="kw">str</span>(tweets)</span></code></pre></div>
<pre><code>## tibble [100 × 5] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ created_at       : POSIXct[1:100], format: &quot;2021-03-24 08:53:52&quot; &quot;2021-03-24 08:53:25&quot; &quot;2021-03-24 08:53:52&quot; &quot;2021-03-24 08:53:51&quot; ...
##  $ screen_name      : chr [1:100] &quot;DoYourThingUK&quot; &quot;DoYourThingUK&quot; &quot;AlexS1595&quot; &quot;MakesworthAcc&quot; ...
##  $ device           : chr [1:100] &quot;Twitter for iPhone&quot; &quot;Twitter for iPhone&quot; &quot;Twitter for iPhone&quot; &quot;Twitter Web App&quot; ...
##  $ retweet_count    : int [1:100] 0 0 3 0 4 96 0 1 0 3 ...
##  $ log_retweet_count: num [1:100] 0 0 1.39 0 1.61 ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   created_at = col_datetime(format = &quot;%Y-%m-%d %H:%M:%S&quot;),
##   ..   screen_name = col_character(),
##   ..   source = col_character(),
##   ..   retweet_count = col_integer()
##   .. )</code></pre>
<p>Sometimes variables are stored in the data.frame in the wrong format (see the paragraph “data type”), so we want to convert them into a new format. For this purpose we can use, again, the function <strong>mutate</strong>, along with other functions such <em>as.integer</em>, <em>as.numeric</em>, <em>as.character</em>, <em>as.factors</em>, or <em>as.logical</em>, <em>as.Date</em>, or <em>as.POSIXct()</em> based on the desired data format (it is possible and advisable to upload the data by paying attention to the type of data. If you upload the data in the right format, you can skip this step).</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="basic-data-wrangling-with-tidyverse.html#cb74-1"></a>tweets <span class="op">%&gt;%</span></span>
<span id="cb74-2"><a href="basic-data-wrangling-with-tidyverse.html#cb74-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">device =</span> <span class="kw">as.character</span>(device)) <span class="op">%&gt;%</span></span>
<span id="cb74-3"><a href="basic-data-wrangling-with-tidyverse.html#cb74-3"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   created_at          screen_name   device             retweet_count log_retweet_count
##   &lt;dttm&gt;              &lt;chr&gt;         &lt;chr&gt;                      &lt;int&gt;             &lt;dbl&gt;
## 1 2021-03-24 08:53:52 DoYourThingUK Twitter for iPhone             0              0   
## 2 2021-03-24 08:53:25 DoYourThingUK Twitter for iPhone             0              0   
## 3 2021-03-24 08:53:52 AlexS1595     Twitter for iPhone             3              1.39
## 4 2021-03-24 08:53:51 MakesworthAcc Twitter Web App                0              0   
## 5 2021-03-24 08:53:39 MakesworthAcc Twitter Web App                4              1.61
## 6 2021-03-24 08:53:51 GGrahambute   Twitter for iPad              96              4.57</code></pre>
</div>
<div id="summarize-and-group_by" class="section level2">
<h2><span class="header-section-number">3.4</span> Summarize and group_by</h2>
<p>To aggregate data and calculate synthetic values (for instance, the average number of tweets <em>by day</em>), it can be used the function <em>group_by</em> (to aggregate data, for instance by day), and <em>summarize</em>, to calculate the summary values.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="basic-data-wrangling-with-tidyverse.html#cb76-1"></a>tweets_summary &lt;-<span class="st"> </span>tweets <span class="op">%&gt;%</span></span>
<span id="cb76-2"><a href="basic-data-wrangling-with-tidyverse.html#cb76-2"></a><span class="st">  </span><span class="kw">group_by</span>(screen_name) <span class="op">%&gt;%</span></span>
<span id="cb76-3"><a href="basic-data-wrangling-with-tidyverse.html#cb76-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">average_retweets =</span> <span class="kw">mean</span>(retweet_count))</span>
<span id="cb76-4"><a href="basic-data-wrangling-with-tidyverse.html#cb76-4"></a></span>
<span id="cb76-5"><a href="basic-data-wrangling-with-tidyverse.html#cb76-5"></a><span class="kw">head</span>(tweets_summary)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   screen_name     average_retweets
##   &lt;chr&gt;                      &lt;dbl&gt;
## 1 2EXvoZ6nublpw1F              164
## 2 AdilHaiderMD                  80
## 3 AlexS1595                      3
## 4 Andecave                      20
## 5 anshunandanpra4                2
## 6 ApKido                       150</code></pre>
<p>It is also possible to create more than one summary variables at once.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="basic-data-wrangling-with-tidyverse.html#cb78-1"></a>tweets_summary &lt;-<span class="st"> </span>tweets <span class="op">%&gt;%</span></span>
<span id="cb78-2"><a href="basic-data-wrangling-with-tidyverse.html#cb78-2"></a><span class="st">  </span><span class="kw">group_by</span>(screen_name) <span class="op">%&gt;%</span></span>
<span id="cb78-3"><a href="basic-data-wrangling-with-tidyverse.html#cb78-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">average_retweets =</span> <span class="kw">mean</span>(retweet_count),</span>
<span id="cb78-4"><a href="basic-data-wrangling-with-tidyverse.html#cb78-4"></a>            <span class="dt">average_log_retweets =</span> <span class="kw">mean</span>(log_retweet_count))</span>
<span id="cb78-5"><a href="basic-data-wrangling-with-tidyverse.html#cb78-5"></a></span>
<span id="cb78-6"><a href="basic-data-wrangling-with-tidyverse.html#cb78-6"></a><span class="kw">head</span>(tweets_summary)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   screen_name     average_retweets average_log_retweets
##   &lt;chr&gt;                      &lt;dbl&gt;                &lt;dbl&gt;
## 1 2EXvoZ6nublpw1F              164                 5.11
## 2 AdilHaiderMD                  80                 4.39
## 3 AlexS1595                      3                 1.39
## 4 Andecave                      20                 3.04
## 5 anshunandanpra4                2                 1.10
## 6 ApKido                       150                 5.02</code></pre>
<div id="count-occurrences" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Count occurrences</h3>
<p>A useful operation to perform when summarizing data, is to count the occurrences of a certain variable. For instance, to count the number of tweets sent by each user, it can be used the function <strong>n()</strong> inside the <em>summarize</em> function.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="basic-data-wrangling-with-tidyverse.html#cb80-1"></a>tweets_summary &lt;-<span class="st"> </span>tweets <span class="op">%&gt;%</span></span>
<span id="cb80-2"><a href="basic-data-wrangling-with-tidyverse.html#cb80-2"></a><span class="st">  </span><span class="kw">group_by</span>(screen_name) <span class="op">%&gt;%</span></span>
<span id="cb80-3"><a href="basic-data-wrangling-with-tidyverse.html#cb80-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">average_retweets =</span> <span class="kw">mean</span>(retweet_count),</span>
<span id="cb80-4"><a href="basic-data-wrangling-with-tidyverse.html#cb80-4"></a>            <span class="dt">average_log_retweets =</span> <span class="kw">mean</span>(log_retweet_count),</span>
<span id="cb80-5"><a href="basic-data-wrangling-with-tidyverse.html#cb80-5"></a>            <span class="dt">number_of_tweets =</span> <span class="kw">n</span>())</span>
<span id="cb80-6"><a href="basic-data-wrangling-with-tidyverse.html#cb80-6"></a></span>
<span id="cb80-7"><a href="basic-data-wrangling-with-tidyverse.html#cb80-7"></a><span class="kw">head</span>(tweets_summary)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   screen_name     average_retweets average_log_retweets number_of_tweets
##   &lt;chr&gt;                      &lt;dbl&gt;                &lt;dbl&gt;            &lt;int&gt;
## 1 2EXvoZ6nublpw1F              164                 5.11                1
## 2 AdilHaiderMD                  80                 4.39                1
## 3 AlexS1595                      3                 1.39                1
## 4 Andecave                      20                 3.04                1
## 5 anshunandanpra4                2                 1.10                1
## 6 ApKido                       150                 5.02                1</code></pre>
</div>
</div>
<div id="arrange" class="section level2">
<h2><span class="header-section-number">3.5</span> Arrange</h2>
<p>To explore a data set it can be useful to sort the data (e.g.: from the lowest to the highest value of a variable). With tidyverse, we can order a data.frame by using the function <em>arrange</em>.</p>
<p>To sort the data from the highest to the lowest value (descending order) the <em>minus</em> sign (or the “desc” function) has to be added.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="basic-data-wrangling-with-tidyverse.html#cb82-1"></a>tweets_summary  <span class="op">%&gt;%</span></span>
<span id="cb82-2"><a href="basic-data-wrangling-with-tidyverse.html#cb82-2"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>number_of_tweets) <span class="op">%&gt;%</span></span>
<span id="cb82-3"><a href="basic-data-wrangling-with-tidyverse.html#cb82-3"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   screen_name     average_retweets average_log_retweets number_of_tweets
##   &lt;chr&gt;                      &lt;dbl&gt;                &lt;dbl&gt;            &lt;int&gt;
## 1 iprdhzb                    0.667                0.462                3
## 2 benphillips76              3.5                  1.45                 2
## 3 DoYourThingUK              0                    0                    2
## 4 MakesworthAcc              2                    0.805                2
## 5 viralvideovlogs            3.5                  1.45                 2
## 6 2EXvoZ6nublpw1F          164                    5.11                 1</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="basic-data-wrangling-with-tidyverse.html#cb84-1"></a>tweets_summary  <span class="op">%&gt;%</span></span>
<span id="cb84-2"><a href="basic-data-wrangling-with-tidyverse.html#cb84-2"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(average_retweets)) <span class="op">%&gt;%</span></span>
<span id="cb84-3"><a href="basic-data-wrangling-with-tidyverse.html#cb84-3"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   screen_name    average_retweets average_log_retweets number_of_tweets
##   &lt;chr&gt;                     &lt;dbl&gt;                &lt;dbl&gt;            &lt;int&gt;
## 1 Oliver_Miguel1             1988                 7.60                1
## 2 Lil_3arbiii                1627                 7.40                1
## 3 Kittyhawk681               1285                 7.16                1
## 4 JulesFox12                 1091                 7.00                1
## 5 rosaesaa26                  983                 6.89                1
## 6 lewisabzueta                822                 6.71                1</code></pre>
<p>Without the minus sign (or the “desc” command), data are sorted from the lowest to the highest value.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="basic-data-wrangling-with-tidyverse.html#cb86-1"></a>tweets_summary  <span class="op">%&gt;%</span></span>
<span id="cb86-2"><a href="basic-data-wrangling-with-tidyverse.html#cb86-2"></a><span class="st">  </span><span class="kw">arrange</span>(number_of_tweets) <span class="op">%&gt;%</span></span>
<span id="cb86-3"><a href="basic-data-wrangling-with-tidyverse.html#cb86-3"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   screen_name     average_retweets average_log_retweets number_of_tweets
##   &lt;chr&gt;                      &lt;dbl&gt;                &lt;dbl&gt;            &lt;int&gt;
## 1 2EXvoZ6nublpw1F              164                 5.11                1
## 2 AdilHaiderMD                  80                 4.39                1
## 3 AlexS1595                      3                 1.39                1
## 4 Andecave                      20                 3.04                1
## 5 anshunandanpra4                2                 1.10                1
## 6 ApKido                       150                 5.02                1</code></pre>
</div>
<div id="filter" class="section level2">
<h2><span class="header-section-number">3.6</span> Filter</h2>
<p>The function <em>filter</em> keeps only the cases (the “rows”) we want to focus on. The arguments of this function are the conditions that have to be fulfilled to filter the data: a) the name of the column that we want to filter, b) the values to be kept.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="basic-data-wrangling-with-tidyverse.html#cb88-1"></a>tweets <span class="op">%&gt;%</span></span>
<span id="cb88-2"><a href="basic-data-wrangling-with-tidyverse.html#cb88-2"></a><span class="st">  </span><span class="kw">filter</span>(retweet_count <span class="op">&gt;=</span><span class="st"> </span><span class="dv">500</span>) <span class="op">%&gt;%</span></span>
<span id="cb88-3"><a href="basic-data-wrangling-with-tidyverse.html#cb88-3"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>retweet_count)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 5
##    created_at          screen_name     device              retweet_count log_retweet_count
##    &lt;dttm&gt;              &lt;chr&gt;           &lt;chr&gt;                       &lt;int&gt;             &lt;dbl&gt;
##  1 2021-03-24 08:53:31 Oliver_Miguel1  Twitter for Android          1988              7.60
##  2 2021-03-24 08:53:48 Lil_3arbiii     Twitter for iPhone           1627              7.40
##  3 2021-03-24 08:53:48 Kittyhawk681    Twitter Web App              1285              7.16
##  4 2021-03-24 08:53:37 JulesFox12      Twitter for Android          1091              7.00
##  5 2021-03-24 08:53:42 rosaesaa26      Twitter for Android           983              6.89
##  6 2021-03-24 08:53:42 lewisabzueta    Twitter for Android           822              6.71
##  7 2021-03-24 08:53:42 jonvthvn08      Twitter for iPhone            768              6.65
##  8 2021-03-24 08:53:34 florent61647053 Twitter for Android           768              6.65
##  9 2021-03-24 08:53:37 Ritu89903967    Twitter for Android           709              6.57
## 10 2021-03-24 08:53:33 Hurica3         Twitter for iPhone            575              6.36</code></pre>
<p>In the examples below, notice the use of a double equal sign <em>==</em>, and also of the quotation marks to indicate the modalities of a categorical variable.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="basic-data-wrangling-with-tidyverse.html#cb90-1"></a>tweets <span class="op">%&gt;%</span></span>
<span id="cb90-2"><a href="basic-data-wrangling-with-tidyverse.html#cb90-2"></a><span class="st">  </span><span class="kw">filter</span>(retweet_count <span class="op">==</span><span class="st"> </span><span class="dv">1988</span>) </span></code></pre></div>
<pre><code>## # A tibble: 1 x 5
##   created_at          screen_name    device              retweet_count log_retweet_count
##   &lt;dttm&gt;              &lt;chr&gt;          &lt;chr&gt;                       &lt;int&gt;             &lt;dbl&gt;
## 1 2021-03-24 08:53:31 Oliver_Miguel1 Twitter for Android          1988              7.60</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="basic-data-wrangling-with-tidyverse.html#cb92-1"></a>tweets <span class="op">%&gt;%</span></span>
<span id="cb92-2"><a href="basic-data-wrangling-with-tidyverse.html#cb92-2"></a><span class="st">  </span><span class="kw">filter</span>(device <span class="op">==</span><span class="st"> &quot;Twitter for Android&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 33 x 5
##    created_at          screen_name     device              retweet_count log_retweet_count
##    &lt;dttm&gt;              &lt;chr&gt;           &lt;chr&gt;                       &lt;int&gt;             &lt;dbl&gt;
##  1 2021-03-24 08:53:49 marcin_lukawski Twitter for Android             1             0.693
##  2 2021-03-24 08:53:49 LebodyRanya     Twitter for Android             0             0    
##  3 2021-03-24 08:53:47 anshunandanpra4 Twitter for Android             2             1.10 
##  4 2021-03-24 08:53:44 insoumise007    Twitter for Android             5             1.79 
##  5 2021-03-24 08:53:43 Metamorfopsies  Twitter for Android             0             0    
##  6 2021-03-24 08:53:43 keepsmiling_130 Twitter for Android           164             5.11 
##  7 2021-03-24 08:53:43 lovebresil01    Twitter for Android            81             4.41 
##  8 2021-03-24 08:53:42 LightHealing    Twitter for Android             1             0.693
##  9 2021-03-24 08:53:42 lewisabzueta    Twitter for Android           822             6.71 
## 10 2021-03-24 08:53:42 rosaesaa26      Twitter for Android           983             6.89 
## # … with 23 more rows</code></pre>
<p>It is also possible to use several conditions at the same time.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="basic-data-wrangling-with-tidyverse.html#cb94-1"></a>tweets <span class="op">%&gt;%</span></span>
<span id="cb94-2"><a href="basic-data-wrangling-with-tidyverse.html#cb94-2"></a><span class="st">  </span><span class="kw">filter</span>(device <span class="op">==</span><span class="st"> &quot;Twitter for Android&quot;</span>,</span>
<span id="cb94-3"><a href="basic-data-wrangling-with-tidyverse.html#cb94-3"></a>         retweet_count <span class="op">&gt;</span><span class="st"> </span><span class="dv">200</span>) <span class="op">%&gt;%</span></span>
<span id="cb94-4"><a href="basic-data-wrangling-with-tidyverse.html#cb94-4"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>retweet_count)</span></code></pre></div>
<pre><code>## # A tibble: 8 x 5
##   created_at          screen_name     device              retweet_count log_retweet_count
##   &lt;dttm&gt;              &lt;chr&gt;           &lt;chr&gt;                       &lt;int&gt;             &lt;dbl&gt;
## 1 2021-03-24 08:53:31 Oliver_Miguel1  Twitter for Android          1988              7.60
## 2 2021-03-24 08:53:37 JulesFox12      Twitter for Android          1091              7.00
## 3 2021-03-24 08:53:42 rosaesaa26      Twitter for Android           983              6.89
## 4 2021-03-24 08:53:42 lewisabzueta    Twitter for Android           822              6.71
## 5 2021-03-24 08:53:34 florent61647053 Twitter for Android           768              6.65
## 6 2021-03-24 08:53:37 Ritu89903967    Twitter for Android           709              6.57
## 7 2021-03-24 08:53:27 aspeaker66      Twitter for Android           331              5.81
## 8 2021-03-24 08:53:42 JamesAn26254230 Twitter for Android           201              5.31</code></pre>
</div>
<div id="select" class="section level2">
<h2><span class="header-section-number">3.7</span> Select</h2>
<p><strong>Select</strong> is used to keep just some of the columns of the original data.frame. For instance, we can apply the function in order to keep just the column “device” and “retweet_count”.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="basic-data-wrangling-with-tidyverse.html#cb96-1"></a>tweets <span class="op">%&gt;%</span></span>
<span id="cb96-2"><a href="basic-data-wrangling-with-tidyverse.html#cb96-2"></a><span class="st">  </span><span class="kw">select</span>(device, retweet_count) <span class="op">%&gt;%</span></span>
<span id="cb96-3"><a href="basic-data-wrangling-with-tidyverse.html#cb96-3"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   device             retweet_count
##   &lt;chr&gt;                      &lt;int&gt;
## 1 Twitter for iPhone             0
## 2 Twitter for iPhone             0
## 3 Twitter for iPhone             3
## 4 Twitter Web App                0
## 5 Twitter Web App                4
## 6 Twitter for iPad              96</code></pre>
</div>
<div id="exercise" class="section level2">
<h2><span class="header-section-number">3.8</span> Exercise</h2>
<p>Here are some exercises to consolidate the fundamental R skills learned during these first lessons:</p>
<ul>
<li><p>Download the csv file <em>tweets_vienna_small.csv</em> in <a href="https://drive.google.com/file/d/1RKPFOLsIAPLuACcrcB0iiq289CvDDgiT/view?usp=sharing">this folder</a> and put it into the project folder “data”</p></li>
<li><p>Upload the data set in R, setting the appropriate formats for the variables</p></li>
<li><p>Create a new script named “data-manipulation” with your surname and name as follows: <em>“YOUR SURNAME-YOUR NAME-data-manipulation”</em>, and save it</p></li>
<li><p>In the script, write the code to perform the following operations:</p>
<ul>
<li><p>load the library “Tidyverse”</p></li>
<li><p>show the first rows of the data frame by using the function <em>head</em></p></li>
<li><p>create a new data frame “tweets_vienna_small_updated” by updating the dataframe “tweets_vienna_small” by using the function <em>mutate</em> to create a new column “log_friends_count” whose values are the log of the values in the column “friends_count” (you don’t need to add 1 to the values in the column “friends_count”)</p></li>
<li><p>save the updated dataframe “tweets_vienna_small_updated”, by using the following code to save a csv file (please change <em>YOUR SURNAME-YOUR NAME</em> with your actual surname and name): <em>write.csv(tweets_vienna_small_updated, file = “./data/YOUR SURNAME-YOUR NAME-tweets_vienna_small_updated.csv”, row.names=F)</em> (we add row.names=F to avoid saving the number that indexes each row)</p></li>
<li><p>create a new data frame named “summary_tweets_vienna_small” aggregating the data by “screen_name” (using the function <em>group_by</em>) and then summarizing the data (by using the function <em>summarize</em>) as follows:</p>
<ul>
<li><p>in a column named “average_favorite_count”, calculate the average of “favorite_count” by “screen_name” (that is, by user)</p></li>
<li><p>in a column named “average_retweet_count”, calculate the average of “retweet_count” (by user, obviously, since the data are already aggregated by user’ name)</p></li>
<li><p>in a column named “number_of_tweets”, calculate the number of tweets published by each users (by using the function <em>n()</em>)</p></li>
<li><p>save the “summary_tweets_vienna_small” in the data folder of the project, in csv format, and with the name <em>“YOUR SURNAME-YOUR NAME-summary_tweets_vienna_small.csv”</em> (remember to specify <em>row.names=F</em> and to change <em>YOUR SURNAME-YOUR NAME</em> with your actual surname and name)</p></li>
<li><p>create a new data frame object called “summary_tweets_vienna_small_filtered”, where you will save the data.frame summary_tweets_vienna_small, after having filtered the rows with average_retweet_count higher than 10 (by using the function <em>filter</em>), and after having selected the column “screen_name” and “average_retweet_count” (so, you should end up with a data frame with just two columns, “screen_name” and “average_retweet_count”, and the rows with “average_retweet_count” higher than 10)</p></li>
<li><p>save the data frame “summary_tweets_vienna_small_filtered” with the name <em>“YOUR SURNAME-YOUR NAME-summary_tweets_vienna_small_filtered.csv”</em> in the folder data (remember to specify <em>row.names=F</em> and to change <em>YOUR SURNAME-YOUR NAME</em> with your actual surname and name).</p></li>
</ul></li>
</ul></li>
</ul>
<p>Save the script “YOUR SURNAME-YOUR NAME-data-manipulation” with all the code you have used to perform these analysis. Write a comment in the script (using the hash mark <em>#</em>) if you are not able to do something.</p>
<p>Upload the script “YOUR SURNAME-YOUR NAME-data-manipulation.r” and the files “YOUR SURNAME-YOUR NAME-tweets_vienna_small_updated.csv”, “YOUR SURNAME-YOUR NAME-summary_tweets_vienna_small.csv”, and the file “YOUR SURNAME-YOUR NAME-summary_tweets_vienna_small_filtered.csv” on Moodle, in the folder “HomeWork-1”. <em>The deadline is Sunday 11 April</em>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-started-with-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basic-concepts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/nicolarighetti/Introduction-to-Time-Series-Analysis-With-R/edit/master/02-Getting-Started-with-R.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/nicolarighetti/Introduction-to-Time-Series-Analysis-With-R/blob/master/02-Getting-Started-with-R.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
